<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body style="margin:0px;padding:0px;overflow:hidden;">
    <script>
        window.onload = function () {
            var camera, scene, renderer;
            var cameraControls;
            var testtrekker = Trekker();
            var geraakt = false;

           
            
            function init() {
                 scene = new THREE.Scene();
                 camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
                camera.position.set(0, 10, 15);
                var renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);

                var controls = new THREE.OrbitControls(camera, renderer.domElement);

                scene.add(new THREE.AmbientLight(0xffffff, .5));
                var light = new THREE.DirectionalLight(0xffffff, .5);
                light.position.set(10, 10, -10);
                light.intensity = 3;
                scene.add(light);

                scene.add(new THREE.GridHelper(20, 20, "gray", "gray"));

                var objects = [];
             
                //rode bal
                var objOrigin = new THREE.Mesh(new THREE.SphereGeometry(.5, 16, 12), new THREE.MeshLambertMaterial({
                    color: "red"
                }));


                objOrigin.position.x = 10;
                objOrigin.position.z = 10;

                //blauwe bal
                var objDestin = new THREE.Mesh(new THREE.SphereGeometry(.5, 16, 12), new THREE.MeshLambertMaterial({
                    color: "blue"
                }));


                objDestin.position.x = 10;
                objDestin.position.z = -10;


                scene.add(objDestin);
                

                scene.add(objOrigin);

               
                

                //muur maken waar trekker tegenaan rijdt.
                var geometry = new THREE.PlaneGeometry(20, 20, 20);
                var material = new THREE.MeshBasicMaterial({ color: 0xffff00, side: THREE.DoubleSide });
                var plane = new THREE.Mesh(geometry, material);
                plane.rotateY(- Math.PI / 2);
                plane.position.set(10, 0, 0);


                scene.add(plane);

                testtrekker.position.y = -2;
                testtrekker.position.x = -10;  
                testtrekker.scale.set(0.5, 0.5, 0.5);
                testtrekker.rotation.y = (Math.PI / 2)




                objects.push(testtrekker);
                scene.add(testtrekker);

                var raycaster = new THREE.Raycaster();
                var intersects;
                var direction = new THREE.Vector3();
                var far = new THREE.Vector3();
                var clock = new THREE.Clock();
                var time = 0;

                render();

                function render() {
                    time += clock.getDelta();
                    requestAnimationFrame(render);
                    raycaster.set(objOrigin.position, direction.subVectors(objDestin.position, objOrigin.position).normalize());
                    raycaster.far = far.subVectors(objDestin.position, objOrigin.position).length(); // comment this line to have an infinite ray
                    intersects = raycaster.intersectObjects(objects, true);

                    //kleur veranderen van het intersect object

                    for (let i = 0; i < intersects.length; i++) {
                        intersects[i].object.material.color.set(Math.random() * 0xffffff);
                        //intersects[i].object.childeren.position.y = 5;
                       geraakt = true;
                        animatetrekker();
                    }

                   

                    function animatetrekker() {
                        if (geraakt == false) {
                            testtrekker.position.x += 0.2;

                        }

                        else {

                            testtrekker.position.y += 0.2;

                            testtrekker.rotation.x += 0.2;
                            testtrekker.rotation.y += 0.2;

                            geraakt = true;
                            
                        }
                    }
                    animatetrekker();

                    renderer.render(scene, camera);
                }




            }



            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }



            function animate() {
                requestAnimationFrame(animate);
                cameraControls.update();
                renderer.render(scene, camera)
            }

            init();
            animate();
        }
    </script>
    <script src="three.min.js"></script>
    <script src="MTLLoader.js"></script>
    <script src="OBJLoader.js"></script>
    <script src="OrbitControls.js"></script>
    <script src="js/Skybox.js"></script>
    <script src="js/Trekker.js"></script>
    <script src="js/ObjLoaderFunction.js"></script>
    <script src="js/Light.js"></script>
    <script src="Raycaster.js"></script>

</body>
</html>

